<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 320" width="700" height="320" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <!-- Gradients -->
    <linearGradient id="grad-orange" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:0.2"/>
      <stop offset="100%" style="stop-color:#d97706;stop-opacity:0.1"/>
    </linearGradient>
    <linearGradient id="grad-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.2"/>
      <stop offset="100%" style="stop-color:#2563eb;stop-opacity:0.1"/>
    </linearGradient>
    <linearGradient id="grad-green" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e;stop-opacity:0.2"/>
      <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0.1"/>
    </linearGradient>
    <linearGradient id="box-orange" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#d97706;stop-opacity:0.15"/>
    </linearGradient>
    <linearGradient id="box-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#2563eb;stop-opacity:0.15"/>
    </linearGradient>
    <linearGradient id="box-green" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0.15"/>
    </linearGradient>
    <linearGradient id="box-user" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#a855f7;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#9333ea;stop-opacity:0.15"/>
    </linearGradient>

    <!-- Drop shadow filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.4"/>
    </filter>

    <!-- Arrowheads -->
    <marker id="arrow-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22c55e"/>
    </marker>

    <!-- Icon symbols -->
    <symbol id="icon-cloud" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z"/>
    </symbol>
    <symbol id="icon-lock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="3" y="11" width="18" height="11" rx="2"/>
      <path d="M7 11V7a5 5 0 0110 0v4"/>
    </symbol>
    <symbol id="icon-server" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect x="2" y="2" width="20" height="8" rx="2"/>
      <rect x="2" y="14" width="20" height="8" rx="2"/>
      <circle cx="6" cy="6" r="1" fill="currentColor" stroke="none"/>
      <circle cx="6" cy="18" r="1" fill="currentColor" stroke="none"/>
      <line x1="10" y1="6" x2="16" y2="6"/>
      <line x1="10" y1="18" x2="16" y2="18"/>
    </symbol>
  </defs>

  <!-- Background -->
  <rect width="700" height="320" fill="#0f172a" rx="12"/>

  <!-- ===================== LEFT GROUP: External Access ===================== -->
  <rect x="20" y="16" width="290" height="270" rx="8" fill="url(#grad-orange)" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="5,3" filter="url(#shadow)"/>
  <text x="165" y="36" text-anchor="middle" font-size="11" font-weight="600" fill="#f59e0b" letter-spacing="0.5">EXTERNAL ACCESS (INTERNET)</text>

  <!-- External User -->
  <rect x="95" y="48" width="140" height="36" rx="6" fill="url(#box-user)" stroke="#a855f7" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="165" y="63" text-anchor="middle" font-size="12" font-weight="600" fill="#e9d5ff">&#x1f465; External User</text>
  <text x="165" y="77" text-anchor="middle" font-size="10" fill="#c084fc">Public Internet</text>

  <!-- Arrow: External User → Cloudflare Edge -->
  <line x1="165" y1="84" x2="165" y2="108" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrow-orange)"/>

  <!-- Cloudflare Edge -->
  <rect x="80" y="110" width="170" height="36" rx="6" fill="url(#box-orange)" stroke="#f59e0b" stroke-width="1.5" filter="url(#shadow)"/>
  <use href="#icon-cloud" x="84" y="118" width="16" height="16" color="#fde68a"/>
  <text x="170" y="125" text-anchor="middle" font-size="12" font-weight="600" fill="#fde68a">Cloudflare Edge</text>
  <text x="170" y="139" text-anchor="middle" font-size="10" fill="#fcd34d">DDoS Protection / WAF</text>

  <!-- Arrow: Cloudflare Edge → CF Tunnel -->
  <line x1="165" y1="146" x2="165" y2="172" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrow-orange)"/>
  <!-- Label on arrow -->
  <rect x="86" y="152" width="158" height="16" rx="3" fill="#1e293b" opacity="0.85"/>
  <text x="165" y="164" text-anchor="middle" font-size="10" fill="#f59e0b">Sets CF-Connecting-IP header</text>

  <!-- CF Tunnel -->
  <rect x="80" y="174" width="170" height="36" rx="6" fill="url(#box-orange)" stroke="#f59e0b" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="165" y="189" text-anchor="middle" font-size="12" font-weight="600" fill="#fde68a">&#x1f50c; CF Tunnel</text>
  <text x="165" y="203" text-anchor="middle" font-size="10" fill="#fcd34d">cloudflared daemon</text>

  <!-- Arrow: CF Tunnel → Vaultwarden (diagonal left-to-center) -->
  <path d="M 165 210 L 165 240 Q 165 258 248 258" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arrow-green)"/>
  <!-- Label -->
  <rect x="120" y="238" width="82" height="14" rx="3" fill="#1e293b" opacity="0.85"/>
  <text x="161" y="249" text-anchor="middle" font-size="9.5" fill="#22c55e">Direct route</text>

  <!-- ===================== RIGHT GROUP: Internal Access ===================== -->
  <rect x="390" y="16" width="290" height="200" rx="8" fill="url(#grad-blue)" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="5,3" filter="url(#shadow)"/>
  <text x="535" y="36" text-anchor="middle" font-size="11" font-weight="600" fill="#3b82f6" letter-spacing="0.5">INTERNAL ACCESS (LAN)</text>

  <!-- Internal User -->
  <rect x="465" y="48" width="140" height="36" rx="6" fill="url(#box-user)" stroke="#a855f7" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="535" y="63" text-anchor="middle" font-size="12" font-weight="600" fill="#e9d5ff">&#x1f4bb; Internal User</text>
  <text x="535" y="77" text-anchor="middle" font-size="10" fill="#c084fc">Local Network</text>

  <!-- Arrow: Internal User → Caddy HA -->
  <line x1="535" y1="84" x2="535" y2="108" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrow-blue)"/>

  <!-- Caddy HA -->
  <rect x="450" y="110" width="170" height="36" rx="6" fill="url(#box-blue)" stroke="#3b82f6" stroke-width="1.5" filter="url(#shadow)"/>
  <use href="#icon-server" x="454" y="118" width="16" height="16" color="#93c5fd"/>
  <text x="542" y="125" text-anchor="middle" font-size="12" font-weight="600" fill="#bfdbfe">Caddy HA</text>
  <text x="542" y="139" text-anchor="middle" font-size="10" fill="#93c5fd">Reverse Proxy (VIP)</text>

  <!-- Arrow: Caddy → Vaultwarden (diagonal right-to-center) -->
  <path d="M 535 146 L 535 258 Q 535 258 452 258" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arrow-green)"/>
  <!-- Label -->
  <rect x="454" y="192" width="140" height="26" rx="3" fill="#1e293b" opacity="0.85"/>
  <text x="524" y="203" text-anchor="middle" font-size="9.5" fill="#3b82f6">Sets CF-Connecting-IP</text>
  <text x="524" y="214" text-anchor="middle" font-size="9.5" fill="#93c5fd">header (spoofed)</text>

  <!-- ===================== CENTER BOTTOM: Vaultwarden ===================== -->
  <rect x="196" y="232" width="308" height="62" rx="8" fill="url(#grad-green)" stroke="#22c55e" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="350" y="252" text-anchor="middle" font-size="11" font-weight="600" fill="#22c55e" letter-spacing="0.5">BACKEND SERVICE</text>
  <rect x="248" y="258" width="204" height="28" rx="6" fill="url(#box-green)" stroke="#22c55e" stroke-width="1.5"/>
  <use href="#icon-lock" x="255" y="262" width="16" height="16" color="#4ade80"/>
  <text x="358" y="274" text-anchor="middle" font-size="13" font-weight="700" fill="#bbf7d0">Vaultwarden</text>

  <!-- ===================== LEGEND ===================== -->
  <rect x="20" y="295" width="660" height="18" rx="4" fill="#1e293b" opacity="0.6"/>
  <circle cx="38" cy="304" r="4" fill="#f59e0b"/>
  <text x="48" y="308" font-size="10" fill="#94a3b8">External path (bypasses Caddy)</text>
  <circle cx="220" cy="304" r="4" fill="#3b82f6"/>
  <text x="230" y="308" font-size="10" fill="#94a3b8">Internal path (through Caddy)</text>
  <circle cx="400" cy="304" r="4" fill="#22c55e"/>
  <text x="410" y="308" font-size="10" fill="#94a3b8">Converges at Vaultwarden</text>
</svg>
